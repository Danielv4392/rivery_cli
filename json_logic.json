{
  "cross_id": {
    "$oid": "59ac06ff6b028e33a5cbae96"
  },
  "river_definitions": {
    "updated_by": {
      "$oid": "5a8caf1c6b028e3b5c035c4d"
    },
    "updated_by_name": "Taylor Mcgrath",
    "shared_params": {
      "notifications": {
        "on_warning": {},
        "on_failure": {
          "enabled": true,
          "email": "alon@rivery.io, aviv@rivery.io, taylor.mcgrath@rivery.io"
        }
      },
      "fz_connection": {}
    },
    "river_name": "rivery activity stats",
    "_id": {
      "$oid": "59ac06ff6b028e33a5cbae96"
    },
    "source_type": "logic",
    "is_scheduled": true,
    "version_id": {
      "$oid": "5fd3e996f5682c62452fffcf"
    },
    "env_id": {
      "$oid": "563f5b62b0a10e18f0808895"
    },
    "river_code": 5277,
    "account": {
      "$oid": "55bf7c4270fdca16cac18761"
    },
    "river_lock_time": 1552939215,
    "is_locked": false,
    "locked_run_id": "42b64ea3574643baadd0fea1c1ddf181",
    "river_date_updated": {
      "$date": 1607723414678
    },
    "river_date_inserted": {
      "$date": 1504446207301
    },
    "locked_attempts": 0,
    "river_type": "logic",
    "cross_id": {
      "$oid": "59ac06ff6b028e33a5cbae96"
    },
    "river_desc": "",
    "group_id": {
      "update_time": 1505218297834,
      "name": "Usage",
      "color": "#00FFFFFF",
      "is_default": false,
      "insert_time": 1505218297834,
      "_id": {
        "$oid": "59b7cef96b028e496cb98b3e"
      }
    }
  },
  "tasks_definitions": [
    {
      "task_type_name": "Logic Process",
      "related": {
        "connections": [
          {
            "$oid": "55fa8ada70ec07e624d4313d"
          }
        ],
        "rivers": [
          {
            "$oid": "59abe2a26b028e33a5cbae57"
          },
          {
            "$oid": "59ac01766b028e33a5cbae8f"
          },
          {
            "$oid": "59abf6136b028e33a5cbae71"
          },
          {
            "$oid": "5a60be946b028e3e6f600dc2"
          },
          {
            "$oid": "59fa1b2b6b028e7a684ac65c"
          },
          {
            "$oid": "5db823606b028e56fc052788"
          },
          {
            "$oid": "5f072b53f5682c7583327358"
          },
          {
            "$oid": "5fa2bbcff5682c51fcfe52ef"
          },
          {
            "$oid": "5ea1fd2e6b028e55c63b8ca3"
          },
          {
            "$oid": "5e7941376b028e6b55ae2f2b"
          },
          {
            "$oid": "5e99ff436b028e6a694c1bd5"
          },
          {
            "$oid": "5e988bd46b028e35a5a3c7c5"
          },
          {
            "$oid": "5f0731cef5682c758332744f"
          },
          {
            "$oid": "5fa2c105f5682c51fb4faa39"
          }
        ]
      },
      "global_keys": {
        "target_name": "Logic"
      },
      "task_label": "logic",
      "env_id": {
        "$oid": "563f5b62b0a10e18f0808895"
      },
      "is_mapping_lock": false,
      "feeder_module": "{feeders_path}.logic_feeder",
      "task_config": {
        "logic_steps": [
          {
            "status": "",
            "isParallel": true,
            "hash_key_init": "object_hashkey_8976",
            "isEnabled": true,
            "container_running": "run_once",
            "step_name": "ods- US",
            "nodes": [
              {
                "status": "",
                "hash_key_init": "object_hashkey_9019",
                "isEnabled": true,
                "container_running": "run_once",
                "content": {
                  "block_type": "river",
                  "compression": "none",
                  "file_type": "csv",
                  "fields": [],
                  "fzConnection": {},
                  "connection_id": {},
                  "drop_after": false,
                  "target_type": "table",
                  "split_tables": "no",
                  "type": "RECORD",
                  "split_interval": "d",
                  "block_primary_type": "river",
                  "gConnection": {},
                  "use_standard_sql": false,
                  "target_loading": "append",
                  "river_id": {
                    "$oid": "59abe2a26b028e33a5cbae57"
                  },
                  "query_priority": "interactive"
                },
                "hideBlock": true,
                "step_name": "mysql_runs",
                "nodes": []
              },
              {
                "status": "",
                "content": {
                  "block_type": "river",
                  "compression": "none",
                  "file_type": "csv",
                  "fields": [],
                  "connection_id": {},
                  "drop_after": false,
                  "target_type": "table",
                  "split_tables": "no",
                  "type": "RECORD",
                  "split_interval": "d",
                  "block_primary_type": "river",
                  "gConnection": {},
                  "use_standard_sql": false,
                  "target_loading": "append",
                  "river_id": {
                    "$oid": "59ac01766b028e33a5cbae8f"
                  },
                  "query_priority": "interactive"
                },
                "hash_key_init": "object_hashkey_9020",
                "isEnabled": true,
                "container_running": "run_once",
                "disable_errors": true,
                "hideBlock": true,
                "step_name": "mongodb_rivers",
                "nodes": []
              },
              {
                "status": "",
                "hash_key_init": "object_hashkey_9021",
                "isEnabled": true,
                "container_running": "run_once",
                "content": {
                  "block_type": "river",
                  "compression": "none",
                  "file_type": "csv",
                  "fields": [],
                  "connection_id": {},
                  "drop_after": false,
                  "target_type": "table",
                  "split_tables": "no",
                  "type": "RECORD",
                  "split_interval": "d",
                  "block_primary_type": "river",
                  "gConnection": {},
                  "use_standard_sql": false,
                  "target_loading": "append",
                  "river_id": {
                    "$oid": "59abf6136b028e33a5cbae71"
                  },
                  "query_priority": "interactive"
                },
                "hideBlock": true,
                "step_name": "mongodb_accounts",
                "nodes": []
              },
              {
                "status": "",
                "hash_key_init": "object_hashkey_9022",
                "isEnabled": true,
                "container_running": "run_once",
                "content": {
                  "block_type": "river",
                  "compression": "none",
                  "file_type": "csv",
                  "fields": [],
                  "target_loading": "append",
                  "connection_id": {},
                  "drop_after": false,
                  "target_type": "table",
                  "gConnection": {},
                  "split_interval": "d",
                  "block_primary_type": "river",
                  "split_tables": "no",
                  "use_standard_sql": false,
                  "type": "RECORD",
                  "dataset_id": "rivery_internal",
                  "river_id": {
                    "$oid": "5a60be946b028e3e6f600dc2"
                  },
                  "query_priority": "interactive"
                },
                "hideBlock": true,
                "step_name": "mongodb_events",
                "nodes": []
              },
              {
                "status": "",
                "hash_key_init": "object_hashkey_9023",
                "isEnabled": true,
                "container_running": "run_once",
                "content": {
                  "block_type": "river",
                  "compression": "none",
                  "file_type": "csv",
                  "fields": [],
                  "target_loading": "append",
                  "connection_id": {},
                  "drop_after": false,
                  "target_type": "table",
                  "split_interval": "d",
                  "block_primary_type": "river",
                  "split_tables": "no",
                  "use_standard_sql": false,
                  "type": "RECORD",
                  "dataset_id": "rivery_internal",
                  "river_id": {
                    "$oid": "59fa1b2b6b028e7a684ac65c"
                  },
                  "query_priority": "interactive"
                },
                "hideBlock": true,
                "step_name": "mongodb_users",
                "nodes": []
              },
              {
                "status": "",
                "hash_key_init": "object_hashkey_9024",
                "isEnabled": true,
                "container_running": "run_once",
                "content": {
                  "block_type": "river",
                  "compression": "none",
                  "file_type": "csv",
                  "block_primary_type": "river",
                  "connection_id": {},
                  "drop_after": false,
                  "target_type": "table",
                  "type": "RECORD",
                  "split_interval": "d",
                  "query_priority": "interactive",
                  "split_tables": "no",
                  "use_standard_sql": false,
                  "target_loading": "append",
                  "dataset_id": "rivery_internal",
                  "river_id": {
                    "$oid": "5db823606b028e56fc052788"
                  },
                  "fields": []
                },
                "hideBlock": true,
                "step_name": "Mongodb_leads",
                "nodes": []
              },
              {
                "status": "",
                "hash_key_init": "object_hashkey_9025",
                "isEnabled": true,
                "container_running": "run_once",
                "content": {
                  "block_type": "river",
                  "compression": "none",
                  "file_type": "csv",
                  "block_primary_type": "river",
                  "target_loading": "append",
                  "connection_id": {},
                  "drop_after": false,
                  "target_type": "table",
                  "split_interval": "d",
                  "query_priority": "interactive",
                  "split_tables": "no",
                  "use_standard_sql": false,
                  "type": "RECORD",
                  "dataset_id": "rivery_internal",
                  "river_id": {
                    "$oid": "5f072b53f5682c7583327358"
                  },
                  "fields": []
                },
                "hideBlock": true,
                "step_name": "mongodb_groups",
                "nodes": []
              },
              {
                "status": "",
                "hash_key_init": "object_hashkey_9026",
                "isEnabled": true,
                "container_running": "run_once",
                "content": {
                  "block_type": "river",
                  "compression": "none",
                  "file_type": "csv",
                  "block_primary_type": "river",
                  "target_loading": "append",
                  "connection_id": {},
                  "drop_after": false,
                  "target_type": "table",
                  "split_interval": "d",
                  "query_priority": "interactive",
                  "split_tables": "no",
                  "use_standard_sql": false,
                  "type": "RECORD",
                  "dataset_id": "rivery_internal",
                  "river_id": {
                    "$oid": "5fa2bbcff5682c51fcfe52ef"
                  },
                  "fields": []
                },
                "hideBlock": true,
                "step_name": "mongodb_environments",
                "nodes": []
              }
            ]
          },
          {
            "status": "",
            "isParallel": true,
            "hash_key_init": "object_hashkey_8977",
            "isEnabled": true,
            "container_running": "run_once",
            "step_name": "ods-EU",
            "nodes": [
              {
                "status": "",
                "hash_key_init": "object_hashkey_9066",
                "isEnabled": true,
                "container_running": "run_once",
                "content": {
                  "block_type": "river",
                  "compression": "none",
                  "file_type": "csv",
                  "block_primary_type": "river",
                  "target_loading": "append",
                  "connection_id": {},
                  "drop_after": false,
                  "target_type": "table",
                  "split_interval": "d",
                  "query_priority": "interactive",
                  "split_tables": "no",
                  "use_standard_sql": false,
                  "type": "RECORD",
                  "dataset_id": "rivery_internal",
                  "river_id": {
                    "$oid": "5ea1fd2e6b028e55c63b8ca3"
                  },
                  "fields": []
                },
                "hideBlock": true,
                "step_name": "eu_mysql_runs",
                "nodes": []
              },
              {
                "status": "",
                "hash_key_init": "object_hashkey_9067",
                "isEnabled": true,
                "container_running": "run_once",
                "content": {
                  "block_type": "river",
                  "compression": "none",
                  "file_type": "csv",
                  "block_primary_type": "river",
                  "target_loading": "append",
                  "connection_id": {},
                  "drop_after": false,
                  "target_type": "table",
                  "split_interval": "d",
                  "query_priority": "interactive",
                  "split_tables": "no",
                  "use_standard_sql": false,
                  "type": "RECORD",
                  "dataset_id": "rivery_internal",
                  "river_id": {
                    "$oid": "5e7941376b028e6b55ae2f2b"
                  },
                  "fields": []
                },
                "hideBlock": true,
                "step_name": "eu_mongodb_rivers",
                "nodes": []
              },
              {
                "status": "",
                "hash_key_init": "object_hashkey_9068",
                "isEnabled": true,
                "container_running": "run_once",
                "content": {
                  "block_type": "river",
                  "compression": "none",
                  "file_type": "csv",
                  "block_primary_type": "river",
                  "target_loading": "append",
                  "connection_id": {},
                  "drop_after": false,
                  "target_type": "table",
                  "split_interval": "d",
                  "query_priority": "interactive",
                  "split_tables": "no",
                  "use_standard_sql": false,
                  "type": "RECORD",
                  "dataset_id": "rivery_internal",
                  "river_id": {
                    "$oid": "5e99ff436b028e6a694c1bd5"
                  },
                  "fields": []
                },
                "hideBlock": true,
                "step_name": "eu_mongodb_users",
                "nodes": []
              },
              {
                "status": "",
                "hash_key_init": "object_hashkey_9069",
                "isEnabled": true,
                "container_running": "run_once",
                "content": {
                  "block_type": "river",
                  "compression": "none",
                  "file_type": "csv",
                  "block_primary_type": "river",
                  "target_loading": "append",
                  "connection_id": {},
                  "drop_after": false,
                  "target_type": "table",
                  "split_interval": "d",
                  "query_priority": "interactive",
                  "split_tables": "no",
                  "use_standard_sql": false,
                  "type": "RECORD",
                  "dataset_id": "rivery_internal",
                  "river_id": {
                    "$oid": "5e988bd46b028e35a5a3c7c5"
                  },
                  "fields": []
                },
                "hideBlock": true,
                "step_name": "eu_mongodb_accounts",
                "nodes": []
              },
              {
                "status": "",
                "hash_key_init": "object_hashkey_9070",
                "isEnabled": true,
                "container_running": "run_once",
                "content": {
                  "block_type": "river",
                  "compression": "none",
                  "file_type": "csv",
                  "block_primary_type": "river",
                  "target_loading": "append",
                  "connection_id": {},
                  "drop_after": false,
                  "target_type": "table",
                  "split_interval": "d",
                  "query_priority": "interactive",
                  "split_tables": "no",
                  "use_standard_sql": false,
                  "type": "RECORD",
                  "dataset_id": "rivery_internal",
                  "river_id": {
                    "$oid": "5f0731cef5682c758332744f"
                  },
                  "fields": []
                },
                "hideBlock": true,
                "step_name": "eu_mongodb_groups",
                "nodes": []
              },
              {
                "status": "",
                "hash_key_init": "object_hashkey_9071",
                "isEnabled": true,
                "container_running": "run_once",
                "content": {
                  "block_type": "river",
                  "compression": "none",
                  "file_type": "csv",
                  "block_primary_type": "river",
                  "target_loading": "append",
                  "connection_id": {},
                  "drop_after": false,
                  "target_type": "table",
                  "split_interval": "d",
                  "query_priority": "interactive",
                  "split_tables": "no",
                  "use_standard_sql": false,
                  "type": "RECORD",
                  "dataset_id": "rivery_internal",
                  "river_id": {
                    "$oid": "5fa2c105f5682c51fb4faa39"
                  },
                  "fields": []
                },
                "hideBlock": true,
                "step_name": "eu_mongodb_environments",
                "nodes": []
              }
            ]
          },
          {
            "status": "",
            "hash_key_init": "object_hashkey_8978",
            "isEnabled": true,
            "container_running": "run_once",
            "content": {
              "sql_query": "SELECT\n  runs.run_id AS run_id,\n  runs.river_id AS river_id,\n  rivers.river_name AS river_name,\n  runs.run_date AS run_date,\n  runs.run_end_date AS run_end_date,\n  (TIMESTAMP_TO_SEC(runs.run_end_date)-TIMESTAMP_TO_SEC(runs.run_date)) AS duration_sec,\n  runs.account AS account_id,\n  accounts.account_name AS account_name,\n  runs.task_status AS task_status,\n  runs.error_description AS error_description,\n  runs.target_name AS target_name,\n  runs.scheduler_id AS scheduler_id,\n  rivers.source_type AS datasource_id,\n  rivers.shared_params.is_migration AS is_migration,\n  rivers.shared_params.target_type AS target_type,\n  rivers.is_scheduled AS is_scheduled,\n  rivers.shared_params.enable_log AS enable_log,\n  rivers.is_deleted AS river_is_deleted,\n  rivers.updated_by_name as river_updated_by,\n  date(rivers.river_date_updated) as river_date_updated,\n  runs.env_id as env_id,\n  runs.units AS rpu,\n  runs.total_size/(1000*1000) AS total_MB,\n  envs.environment_name as environment_name,\n  envs.is_default as is_default_env,\n  case when accounts.environments_enabled is not null or accounts.environemnts_enabled is not null then true else null end as environments_enabled,\n  'River Run' AS event_type\nFROM (\n  SELECT\n    run_id AS run_id,\n    river_id AS river_id,\n    run_date AS run_date,\n    run_end_date AS run_end_date,\n    account AS account,\n    status AS task_status,\n    units AS units,\n    total_size AS total_size,\n    is_hidden AS is_hidden,\n    error_description AS error_description,\n    target_name AS target_name,\n    scheduler_id AS scheduler_id,\n    env_id\n  FROM\n    [visionbi-cloud:rivery_internal.ods_mysql_runs]) runs\nLEFT JOIN\n  [visionbi-cloud:rivery_internal.ods_mongodb_accounts] AS accounts\nON\n  runs.account = accounts._id\nLEFT JOIN\n  [visionbi-cloud:rivery_internal.ods_mongodb_rivers] AS rivers\nON\n  runs.river_id = rivers._id\nLEFT JOIN\n[visionbi-cloud:rivery_internal.ods_mongodb_environments] AS envs\nON \nruns.env_id = envs._id\nWHERE\n  runs.is_hidden = 0",
              "execute_sql_command": false,
              "block_type": "big_query_sql",
              "compression": "none",
              "file_type": "csv",
              "fields": [],
              "block_primary_type": "sql",
              "connection_id": {},
              "drop_after": false,
              "target_type": "table",
              "gConnection": {
                "$oid": "55fa8ada70ec07e624d4313d"
              },
              "block_db_type": "big_query_sql",
              "target_table": "dwh_fact_stats_activity",
              "type": "RECORD",
              "split_tables": "no",
              "use_standard_sql": false,
              "target_loading": "overwrite",
              "dataset_id": "rivery_internal",
              "split_interval": "d",
              "query_priority": "interactive"
            },
            "hideBlock": true,
            "error_description": "",
            "step_name": "dwh_fact_stats_activity",
            "nodes": []
          },
          {
            "status": "",
            "hash_key_init": "object_hashkey_8979",
            "isEnabled": true,
            "container_running": "run_once",
            "content": {
              "sql_query": "SELECT \naccounts.registration_date as registration_date,\naccounts._id as account_id ,\naccounts.account_name as account_name,\naccounts.account_type as account_type,\naccounts.owner_email as owner_email,\naccounts.step as reg_step_id,\ncase when accounts.step=1 then '1 - Account_Form' \n     when accounts.step=2 then '2 - Verification'\n     when accounts.step=3 then '3 - Test Connection'\n     when accounts.step=4 then '4 - Finish Account Creation'\n     else 'Unknown' end as reg_step_name,\naccounts.status as account_status,\naccounts.first_name as first_name,\naccounts.last_name as last_name,\naccounts.company_name as company_name,\naccounts.country_code as country_code,\naccounts.country as country,\naccounts.phone_number as phone_number,\naccounts.job_title as job_title,\naccounts.is_technical_registration as is_technical_registration,\naccounts.first_referrer_url as first_referrer_url,\naccounts.first_url as first_url,\naccounts.registration_target_type as registration_target_type,\naccounts.current_units as current_rpu_units,\naccounts.limitations.units as limitations_rpu_units,\naccounts.limitations.days_trial as limitations_days_trial,\naccounts.is_active as is_account_active,\naccounts.partner as partner,\naccounts.affiliate as affiliate,\naccounts.wp_referrer as wp_referrer,\nevents.source_interest as source_interest,\nevents.target_interest as target_interest,\nevents.complete_target as complete_target,\nevents.flow_session_run_river as flow_session_run_river,\nevents.flow_session_run_river_success as flow_session_run_river_success,\nevents.flow_session_run_river_failures as flow_session_run_river_failures,\nevents.flow_session_success_run_congrats_message as flow_session_success_run_congrats_message,\nevents.flow_session_mapping_triggered as flow_session_mapping_triggered,\nevents.flow_session_mapping_success as flow_session_mapping_success,\nactivity.total_river_runs as total_river_runs,\nactivity.total_success_river_runs as total_success_river_runs,\nactivity.total_failure_river_runs as total_failure_river_runs\nFROM [visionbi-cloud:rivery_internal.ods_mongodb_accounts] as accounts\nleft join \n(\nSELECT \naccount as account_id,\nmax(case when event_data.name = 'source_interest' then event_data.value else null end) as source_interest,\nmax(case when event_data.name = 'target_interest' then event_data.value else null end) as target_interest,\nmax(case when event_data.name = 'complete_target' then event_data.value else null end) as complete_target,\nsum(case when event_data.name = 'flow_session_run_river' then 1 else 0 end) as flow_session_run_river,\nsum(case when event_data.name = 'flow_session_run_river_success' then 1 else 0 end) as flow_session_run_river_success,\nsum(case when event_data.name = 'flow_session_run_river_failures' then 1 else 0 end) as flow_session_run_river_failures,\nsum(case when event_data.name = 'flow_session_success_run_congrats_message' then 1 else 0 end) as flow_session_success_run_congrats_message,\nsum(case when event_data.name = 'flow_session_mapping_triggered' then 1 else 0 end) as flow_session_mapping_triggered,\nsum(case when event_data.name = '\tflow_session_mapping_success' then 1 else 0 end) as \tflow_session_mapping_success\nFROM [visionbi-cloud:rivery_internal.ods_mongodb_registration_events] \ngroup by account_id\n)events\non accounts._id  = events.account_id\n\nleft join\n(\nSELECT account_id,\nsum(case when task_status in( 'D','E') then 1 else 0 end) as  total_river_runs,\nsum(case when task_status = 'D' then 1 else 0 end) as total_success_river_runs,\nsum(case when task_status = 'E' then 1 else 0 end) as total_failure_river_runs,\nsum(case when task_status = 'D' then rpu else 1 end) as total_rpu\nFROM [visionbi-cloud:rivery_internal.v_fact_stats_activity]\ngroup by account_id\n)activity\non accounts._id  = activity.account_id",
              "execute_sql_command": false,
              "block_type": "big_query_sql",
              "compression": "none",
              "file_type": "csv",
              "fields": [
                {
                  "name": "registration_date",
                  "dateFormat": "yyyy-mm-dd HH:MM:SS",
                  "fields": [],
                  "fieldName": "registration_date",
                  "mode": "NULLABLE",
                  "type": "TIMESTAMP",
                  "id": "registration_date"
                },
                {
                  "name": "account_id",
                  "isKey": true,
                  "fields": [],
                  "fieldName": "account_id",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "account_id"
                },
                {
                  "name": "account_name",
                  "fields": [],
                  "fieldName": "account_name",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "account_name"
                },
                {
                  "name": "account_type",
                  "fields": [],
                  "fieldName": "account_type",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "account_type"
                },
                {
                  "name": "owner_email",
                  "fields": [],
                  "fieldName": "owner_email",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "owner_email"
                },
                {
                  "name": "reg_step_id",
                  "fields": [],
                  "fieldName": "reg_step_id",
                  "mode": "NULLABLE",
                  "type": "INTEGER",
                  "id": "reg_step_id"
                },
                {
                  "name": "reg_step_name",
                  "fields": [],
                  "fieldName": "reg_step_name",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "reg_step_name"
                },
                {
                  "name": "account_status",
                  "fields": [],
                  "fieldName": "account_status",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "account_status"
                },
                {
                  "name": "first_name",
                  "fields": [],
                  "fieldName": "first_name",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "first_name"
                },
                {
                  "name": "last_name",
                  "fields": [],
                  "fieldName": "last_name",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "last_name"
                },
                {
                  "name": "company_name",
                  "fields": [],
                  "fieldName": "company_name",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "company_name"
                },
                {
                  "name": "country_code",
                  "fields": [],
                  "fieldName": "country_code",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "country_code"
                },
                {
                  "name": "country",
                  "fields": [],
                  "fieldName": "country",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "country"
                },
                {
                  "name": "phone_number",
                  "fields": [],
                  "fieldName": "phone_number",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "phone_number"
                },
                {
                  "name": "job_title",
                  "fields": [],
                  "fieldName": "job_title",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "job_title"
                },
                {
                  "name": "is_technical_registration",
                  "fields": [],
                  "fieldName": "is_technical_registration",
                  "mode": "NULLABLE",
                  "type": "BOOLEAN",
                  "id": "is_technical_registration"
                },
                {
                  "fieldName": "wp_referrer",
                  "alias": "wp_referrer",
                  "type": "STRING",
                  "id": "656331",
                  "name": ""
                },
                {
                  "name": "first_referrer_url",
                  "fields": [],
                  "fieldName": "first_referrer_url",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "first_referrer_url"
                },
                {
                  "name": "first_url",
                  "fields": [],
                  "fieldName": "first_url",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "first_url"
                },
                {
                  "name": "registration_target_type",
                  "fields": [],
                  "fieldName": "registration_target_type",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "registration_target_type"
                },
                {
                  "name": "current_rpu_units",
                  "fields": [],
                  "fieldName": "current_rpu_units",
                  "mode": "NULLABLE",
                  "type": "INTEGER",
                  "id": "current_rpu_units"
                },
                {
                  "name": "limitations_rpu_units",
                  "fields": [],
                  "fieldName": "limitations_rpu_units",
                  "mode": "NULLABLE",
                  "type": "INTEGER",
                  "id": "limitations_rpu_units"
                },
                {
                  "name": "limitations_days_trial",
                  "fields": [],
                  "fieldName": "limitations_days_trial",
                  "mode": "NULLABLE",
                  "type": "INTEGER",
                  "id": "limitations_days_trial"
                },
                {
                  "name": "is_account_active",
                  "fields": [],
                  "fieldName": "is_account_active",
                  "mode": "NULLABLE",
                  "type": "BOOLEAN",
                  "id": "is_account_active"
                },
                {
                  "name": "source_interest",
                  "fields": [],
                  "fieldName": "source_interest",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "source_interest"
                },
                {
                  "name": "target_interest",
                  "fields": [],
                  "fieldName": "target_interest",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "target_interest"
                },
                {
                  "name": "complete_target",
                  "fields": [],
                  "fieldName": "complete_target",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "complete_target"
                },
                {
                  "name": "flow_session_run_river",
                  "fields": [],
                  "fieldName": "flow_session_run_river",
                  "mode": "NULLABLE",
                  "type": "INTEGER",
                  "id": "flow_session_run_river"
                },
                {
                  "name": "flow_session_run_river_success",
                  "fields": [],
                  "fieldName": "flow_session_run_river_success",
                  "mode": "NULLABLE",
                  "type": "INTEGER",
                  "id": "flow_session_run_river_success"
                },
                {
                  "name": "flow_session_run_river_failures",
                  "fields": [],
                  "fieldName": "flow_session_run_river_failures",
                  "mode": "NULLABLE",
                  "type": "INTEGER",
                  "id": "flow_session_run_river_failures"
                },
                {
                  "name": "flow_session_success_run_congrats_message",
                  "fields": [],
                  "fieldName": "flow_session_success_run_congrats_message",
                  "mode": "NULLABLE",
                  "type": "INTEGER",
                  "id": "flow_session_success_run_congrats_message"
                },
                {
                  "name": "flow_session_mapping_triggered",
                  "fields": [],
                  "fieldName": "flow_session_mapping_triggered",
                  "mode": "NULLABLE",
                  "type": "INTEGER",
                  "id": "flow_session_mapping_triggered"
                },
                {
                  "name": "flow_session_mapping_success",
                  "fields": [],
                  "fieldName": "flow_session_mapping_success",
                  "mode": "NULLABLE",
                  "type": "INTEGER",
                  "id": "flow_session_mapping_success"
                },
                {
                  "name": "total_river_runs",
                  "fields": [],
                  "fieldName": "total_river_runs",
                  "mode": "NULLABLE",
                  "type": "INTEGER",
                  "id": "total_river_runs"
                },
                {
                  "name": "total_success_river_runs",
                  "fields": [],
                  "fieldName": "total_success_river_runs",
                  "mode": "NULLABLE",
                  "type": "INTEGER",
                  "id": "total_success_river_runs"
                },
                {
                  "name": "total_failure_river_runs",
                  "fields": [],
                  "fieldName": "total_failure_river_runs",
                  "mode": "NULLABLE",
                  "type": "INTEGER",
                  "id": "total_failure_river_runs"
                },
                {
                  "name": "partner",
                  "fields": [],
                  "fieldName": "partner",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "partner"
                },
                {
                  "name": "affiliate",
                  "fields": [],
                  "fieldName": "affiliate",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "affiliate"
                }
              ],
              "block_primary_type": "sql",
              "connection_id": {},
              "drop_after": false,
              "target_type": "table",
              "gConnection": {
                "$oid": "55fa8ada70ec07e624d4313d"
              },
              "block_db_type": "big_query_sql",
              "target_table": "dwh_dim_accounts_profiles",
              "type": "RECORD",
              "split_tables": "no",
              "use_standard_sql": false,
              "target_loading": "overwrite",
              "dataset_id": "rivery_internal",
              "split_interval": "d",
              "query_priority": "interactive"
            },
            "hideBlock": true,
            "error_description": "",
            "step_name": "dwh_dim_accounts_profiles",
            "step_id": "b3e562afac2546bbbc23872a892726d0",
            "nodes": []
          },
          {
            "status": "",
            "hash_key_init": "object_hashkey_8980",
            "isEnabled": true,
            "container_running": "run_once",
            "content": {
              "sql_query": "SELECT user_email ,cast(min(insert_time) as timestamp) as event_time,min(first_url) as first_url,'book_demo' as event_type \nFROM `visionbi-cloud.rivery_internal.ods_mongodb_leads` \nwhere lower(user_email) not like '%riverytest%'\ngroup by user_email\n\nunion all\n\nselect user_email ,cast(event_time as timestamp) as event_time,first_url ,'signup' as event_type\nfrom(\nSELECT user_details.user_email as user_email,min(event_data.name) as event_data_name,\nmin(event_date) as event_time,min(user_details.first_url) as first_url FROM `visionbi-cloud.rivery_internal.ods_mongodb_registration_events`\nWHERE event_data.name=\"user_signup_password_sent_verification\" \nand lower(user_details.user_email) not like '%riverytest%'\ngroup by user_email) temp\n\n\nunion all\nselect user_email ,cast(event_time as timestamp) as event_time,first_url,'signup' as event_type\nfrom(\nSELECT  user_details.user_email  as user_email,min(user_details.insert_time) as event_time , min(user_details.first_url) as first_url\nFROM `visionbi-cloud.rivery_internal.ods_mongodb_registration_events` \nwhere event_data.name in(\t'user_email_domain_type')\nand lower(user_details.user_id) not like '%riverytest%'\ngroup by user_email\n)temp\n\n\nunion all\n\n\nselect user_email,cast(event_time as timestamp) as event_time,first_url,'registration_completed' as event_type\nfrom(\nselect owner_email as user_email, registration_date as event_time, first_url, \"registration_completed\" as event_type FROM `visionbi-cloud.rivery_internal.ods_mongodb_accounts`\nwhere lower(owner_email) not like '%riverytest%'\n)temp\n\n\n\nunion all\n\nselect user_email,cast(event_time as timestamp) as event_time,first_url,'is_paying_account' as event_type\nfrom(\nselect owner_email as user_email, registration_date as event_time, first_url, \"registration_completed\" as event_type FROM `visionbi-cloud.rivery_internal.ods_mongodb_accounts`\nwhere lower(owner_email) not like '%riverytest%' and status='active'\n)temp\n\n",
              "execute_sql_command": false,
              "block_type": "big_query_sql",
              "compression": "none",
              "file_type": "csv",
              "fields": [
                {
                  "name": "user_email",
                  "isKey": true,
                  "fields": [],
                  "fieldName": "user_email",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "user_email"
                },
                {
                  "name": "event_time",
                  "dateFormat": "yyyy-mm-dd HH:MM:SS",
                  "fields": [],
                  "fieldName": "event_time",
                  "mode": "NULLABLE",
                  "type": "TIMESTAMP",
                  "id": "event_time"
                },
                {
                  "name": "first_url",
                  "fields": [],
                  "fieldName": "first_url",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "first_url"
                },
                {
                  "name": "event_type",
                  "isKey": true,
                  "fields": [],
                  "fieldName": "event_type",
                  "mode": "NULLABLE",
                  "type": "STRING",
                  "id": "event_type"
                }
              ],
              "warning_mapping": true,
              "connection_id": {},
              "drop_after": false,
              "target_type": "table",
              "split_tables": "no",
              "block_db_type": "big_query_sql",
              "split_interval": "d",
              "type": "RECORD",
              "block_primary_type": "sql",
              "gConnection": {
                "$oid": "55fa8ada70ec07e624d4313d"
              },
              "use_standard_sql": true,
              "target_loading": "overwrite",
              "dataset_id": "rivery_internal",
              "target_table": "dwh_fact_marketing_basic_events",
              "query_priority": "interactive"
            },
            "hideBlock": true,
            "error_description": "",
            "step_name": "dwh_fact_marketing_basic_events",
            "step_id": "8f5407c7dcac4f249906b051ea2c211c",
            "nodes": []
          },
          {
            "status": "",
            "hash_key_init": "object_hashkey_8981",
            "isEnabled": true,
            "container_running": "run_once",
            "content": {
              "execute_sql_command": false,
              "block_type": "big_query_sql",
              "compression": "none",
              "file_type": "csv",
              "fields": [],
              "target_loading": "overwrite",
              "connection_id": {},
              "drop_after": false,
              "target_type": "table",
              "split_tables": "no",
              "block_db_type": "big_query_sql",
              "target_table": "dwh_dim_companies",
              "type": "RECORD",
              "block_primary_type": "sql",
              "gConnection": {
                "$oid": "55fa8ada70ec07e624d4313d"
              },
              "use_standard_sql": true,
              "sql_query": "SELECT \nproperties_website_value as company_website,\nproperties_is_public_value as company_is_public,\nproperties_hs_analytics_source_data_1_value as company_hs_analytics_source_data_1,\nproperties_annualrevenue_value as company_annualrevenue,\nisdeleted as company_isdeleted,\nproperties_first_contact_createdate_value as company_first_contact_createdate,\nproperties_num_notes_value as company_num_notes,\nproperties_recent_conversion_event_name_value as company_recent_conversion_event_name,\nproperties_hs_analytics_num_page_views_value as company_hs_analytics_num_page_views,\nproperties_web_technologies_value as company_web_technologies,\nproperties_hs_last_logged_call_date_value as company_hs_last_logged_call_date,\nproperties_type_value as company_type,\nproperties_lifecyclestage_value as company_lifecyclestage,\ncompanyid as company_id,\nproperties_zip_value as company_zip,\nproperties_hs_lastmodifieddate_value as company_hs_lastmodifieddate,\nproperties_hs_analytics_source_value as company_hs_analytics_source,\nproperties_hs_analytics_source_data_2_value as company_hs_analytics_source_data_2,\nproperties_hubspot_owner_id_value as company_hubspot_owner_id,\nproperties_description_value as company_description,\nproperties_hs_is_target_account_value as company_hs_is_target_account,\nproperties_createdate_value as company_createdate,\nproperties_num_associated_contacts_value as company_num_associated_contacts,\nproperties_name_value as company_name,\nproperties_timezone_value as company_timezone,\nproperties_industry_value as company_industry,\nproperties_state_value as company_state,\nproperties_country_value as company_country,\nproperties_domain_value as company_domain,\nproperties_first_conversion_event_name_value as company_first_conversion_event_name,\nproperties_city_value as company_city_value\nFROM `visionbi-cloud.rivery_internal.hubspot_companies`",
              "dataset_id": "rivery_internal",
              "split_interval": "d",
              "query_priority": "interactive"
            },
            "hideBlock": true,
            "step_name": "dwh_dim_companies",
            "step_id": "04beae0c9d0a47cba07b0e29d08a8d68",
            "nodes": []
          },
          {
            "status": "",
            "hash_key_init": "object_hashkey_8982",
            "isEnabled": true,
            "container_running": "run_once",
            "content": {
              "sql_query": "SELECT fact.*,\nac.account_type as account_type,\nhub.deal_id,\nhub.deal_name,\nhub.cs_owner_name,\nhub.current_deal_pipeline,\nhub.current_deal_stage,\nhub.deal_owner_name,\nhub.desired_outcome_group,\nhub.cs_expected_users_id,\nhub.cs_expected_native_sources_id,\nb.Package_name,\nb.Package_RPU_s as Package_RPUs,\nb.Subscription_Start_Date,\nb.Total_Months as Package_Total_Months,\nb.Payments_Method__Monthly__Yearly_ as Package_Payment_Frequency,\nb.Price_Per_Month__USD_ as Package_Monthly_Price,\nb.Discount as Package_discount,\nb.Package_total_amount__USD_ as Package_Total_Amount,\nb.Booking_ARR__Before_Excess_ as Packing_Booking_ARR,\nb.Excess_Cost_Per_RPUs,\nb.First_Contract_Date\nFROM `visionbi-cloud.rivery_internal.dwh_fact_stats_activity` fact\nleft join `visionbi-cloud.rivery_internal.ods_mongodb_accounts` ac\non fact.account_id = ac._id\nleft join `visionbi-cloud.rivery_internal.dwh_hubspot_deal_mapping` hub\non fact.account_id = hub.rivery_account_id\nleft join `visionbi-cloud.rivery_internal.billing` b\non fact.account_id = b.Rivery_Account_ID\nwhere run_date >= '2020-01-01' \n",
              "execute_sql_command": false,
              "block_type": "big_query_sql",
              "compression": "none",
              "file_type": "csv",
              "fields": [],
              "block_primary_type": "sql",
              "connection_id": {},
              "drop_after": false,
              "target_type": "table",
              "gConnection": {
                "$oid": "55fa8ada70ec07e624d4313d"
              },
              "block_db_type": "big_query_sql",
              "target_table": "dwh_fact_stats_activity_gds",
              "type": "RECORD",
              "split_tables": "no",
              "use_standard_sql": true,
              "target_loading": "overwrite",
              "dataset_id": "rivery_internal",
              "split_interval": "d",
              "query_priority": "interactive"
            },
            "hideBlock": true,
            "step_name": "dwh_fact_stats_activity (GDS+Tableau)",
            "nodes": []
          }
        ],
        "condition_name_counter": 0,
        "step_name_counter": 24,
        "variables": {},
        "fz_batched": true,
        "container_name_counter": 4,
        "datasource_id": "logic"
      },
      "task_type_id": "logic",
      "task_process_module": "{processes_path}.logic_process",
      "is_target_task": false,
      "river_id": {
        "$oid": "59ac06ff6b028e33a5cbae96"
      },
      "ordinal": 0,
      "datasource_id": "logic",
      "updated_by": {
        "$oid": "5a8caf1c6b028e3b5c035c4d"
      },
      "schedule": {
        "endDate_beforeSave": "2020-12-12T13:09:12.078Z",
        "endDate": {},
        "job_id": "59ac06ff6b028e33a5cbae97",
        "isEnabled": true,
        "cronExp": "0 24 0/4 1/1 * ? *",
        "sched": {
          "hour": "5",
          "min": 0,
          "showCrontab": false,
          "days": {
            "days": 1
          },
          "month": {
            "radioMon": 0,
            "months": 1,
            "days": 1,
            "month": 1
          },
          "hours": {
            "hours": 5,
            "radioHour": "0"
          },
          "year": {
            "radioYear": 0,
            "days": 1
          },
          "minutes": 1
        },
        "currentTab": "Custom",
        "addStratDate": false
      },
      "task_code": 8838,
      "task_method": "logic_v3",
      "pull_translate": {
        "fields": "get_result_columns",
        "databases": "get_databases",
        "datasets": "get_datasets",
        "results": "get_results",
        "schemas": "get_schemas"
      },
      "connection_id": {},
      "version_id": {
        "$oid": "5fd3e996f5682c62452fffcf"
      },
      "is_synchronized": true,
      "current_workers_running": 1,
      "account": {
        "$oid": "55bf7c4270fdca16cac18761"
      },
      "task_date_updated": {
        "$date": 1607723414675
      },
      "is_deleted": false,
      "max_no_of_files": 250,
      "is_feeder_lock": false,
      "task_name": "Logic process",
      "task_display_name": "Logic Process",
      "pull_target": "logic",
      "_id": {
        "$oid": "59ac06ff6b028e33a5cbae97"
      },
      "is_worker_lock": true
    }
  ],
  "_id": {
    "$oid": "59ac06ff6b028e33a5cbae96"
  }
}